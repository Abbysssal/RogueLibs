# Установка

import Tabs from '@site/src/components/Tabs';
import TabItem from '@site/src/components/TabItem';
import MicrosoftButton from '@site/src/components/MicrosoftButton';
import useBaseUrl from '@docusaurus/useBaseUrl';

## Устанавливаем BepInEx {#bepinex}

**Если у вас уже установлен BepInEx, [пропустите этот шаг](#roguelibs).**

### Скачиваем BepInEx {#bepinex-downloading}

**[Перейдите сюда](https://github.com/BepInEx/BepInEx/releases/latest) и скачайте версию для вашей ОС:**

<Tabs
    groupId="os"
    defaultValue="win"
    values={[
        {label: 'Windows', value: 'win'},
        {label: 'Linux', value: 'linux'},
        {label: 'macOS', value: 'macos'},
    ]}>
<TabItem value="win">

Скачайте версию BepInEx для вашего типа системы:

- **`BepInEx_x64_5.x.y.z.zip`** - для **64-битных** систем.
- **`BepInEx_x86_5.x.y.z.zip`** - для **32-битных** систем.

Вот парочка советов:

- Если у вас **больше 4 Гб ОП**, то у вас определённо **64-битная ОС**. 32-битная версия просто-напросто не может использовать больше 4 Гб ОП, из-за, ну знаете, 32 битов (2^32 байт = 4 гигабайта).
- Если у вас Windows 10, <MicrosoftButton link="ms-settings:about">Откройте "О системе"</MicrosoftButton> (или `⊞ Win`+`I` > **Система** > **О системе**). Вы увидите, какая у вас стоит версия Windows под **Характеристика устройства: Тип системы**.
- Если у вас Windows 7 или 8, тогда [переходите сюда](https://support.microsoft.com/ru-ru/windows/какая-у-меня-версия-операционной-системы-windows-628bec99-476a-2c13-5296-9dd081cdd808#ID0EBBD=Windows_7).

</TabItem>
<TabItem values={["linux", "macos"]}>

- Просто скачайте **`BepInEx_unix_5.x.y.z.zip`.**

</TabItem>
</Tabs>

### Извлекаем файлы {#bepinex-extract}

<Tabs
    groupId="vendor"
    defaultValue="steam"
    values={[
        {label: 'Я знаю где моя игра установлена!', value: 'none'},
        {label: 'Steam', value: 'steam'},
        {label: 'GOG', value: 'gog'},
    ]}>
<TabItem value="steam">

Откройте Библиотеку игр Steam, кликните ПКМ по игре и выберите **Свойства...**:

<img src={useBaseUrl('/img/installation/finding-the-game-1.png')} width='300'/>

Перейдите на **Локальные файлы** и нажмите **Обзор...**:

<img src={useBaseUrl('/img/installation/finding-the-game-2.png')} width='600'/>

</TabItem>
<TabItem value="gog">

Поищите на следующих путях:

<Tabs
    groupId="os"
    defaultValue="win"
    values={[
        {label: 'Windows', value: 'win'},
        {label: 'Linux', value: 'linux'},
        {label: 'macOS', value: 'macos'},
    ]}>
<TabItem value="win">

- `C:\GOG Games`;
- `C:\Program Files (x86)\GOG.com`;
- `C:\Program Files\GOGcom`; <!-- ага, без точки -->

</TabItem>
<TabItem values={["linux", "macos"]}>

- `$HOME/GOG Games`;

</TabItem>
</Tabs>

</TabItem>
</Tabs>

**Извлеките содержимое .zip архива в корневую папку игры.**

<Tabs
    groupId="os"
    defaultValue="win"
    values={[
        {label: 'Windows', value: 'win'},
        {label: 'Linux', value: 'linux'},
        {label: 'macOS', value: 'macos'},
    ]}>
<TabItem value="win">

Убедитесь, что извлекли правильно. Похоже, что это довольно легко сделать неправильно.

- Убедитесь что папка `BepInEx` извлечена в ту же папку, где находится исполняемый файл вашей игры (`StreetsOfRogue.exe`);
- Убедитесь что вы извлекли файлы `doorstop_config.ini` и `winhttp.dll` тоже;

</TabItem>
<TabItem value="linux">

Убедитесь, что извлекли правильно. Похоже, что это довольно легко сделать неправильно.

- Убедитесь что папки `BepInEx` и `doorstop_libs` извлечены в ту же папку, где находится исполняемый файл вашей игры (`StreetsOfRogue.x86` или `StreetsOfRogue.x86_64`);
- Убедитесь что вы извлекли файл `run_bepinex.sh` тоже;

</TabItem>
<TabItem value="macos">

Убедитесь, что извлекли правильно. Похоже, что это довольно легко сделать неправильно.

- Убедитесь что папки `BepInEx` и `doorstop_libs` извлечены в ту же папку, где находится исполняемый файл вашей игры (`StreetsOfRogue.app`);
- Убедитесь что вы извлекли файл `run_bepinex.sh` тоже;

</TabItem>
</Tabs>

### Запускаем игру {#bepinex-first-run}

:::note
Вам надо запустить игру хотя бы один раз, чтобы BepInEx сгенерировал нужные файлы настроек и папки!
:::

import BrowserWindow from '@site/src/components/BrowserWindow';

<Tabs
    groupId="os"
    defaultValue="win"
    values={[
        {label: 'Windows', value: 'win'},
        {label: 'Linux', value: 'linux'},
        {label: 'macOS', value: 'macos'},
    ]}>
<TabItem value="win">

Просто запустите игру. Или через исполняемый файл, или через любой лаунчер.

Вы можете закрыть игру, как только увидите загрузочный экран или логотип.

</TabItem>
<TabItem value="linux">

Откройте приложенный файл `run_bepinex.sh` и вставьте название исполняемого файла в выделенную строчку:

```bash title="run_bepinex.sh"
#!/bin/sh
# BepInEx running script
#
# This script is used to run a Unity game with BepInEx enabled.
#
# Usage: Configure the script below and simply run this script when you want to run your game modded.

# -------- SETTINGS --------
# ---- EDIT AS NEEDED ------

# EDIT THIS: The name of the executable to run
# LINUX: This is the name of the Unity game executable 
# MACOS: This is the name of the game app folder, including the .app suffix
# highlight-next-line
executable_name="StreetsOfRogue"

# The rest is automatically handled by BepInEx
# ...
```

Откройте терминал в корневой папке игры и дайте скрипту разрешение на выполнение:

<BrowserWindow>

```bash
chmod u+x run_bepinex.sh
```

</BrowserWindow>

Теперь вы можете запустить BepInEx, выполнив этот скрипт:

<BrowserWindow>

```bash
./run_bepinex.sh
```

</BrowserWindow>

</TabItem>
<TabItem value="macos">

Откройте приложенный файл `run_bepinex.sh` и вставьте название исполняемого файла в выделенную строчку **(с расширением `.app`)**:

```bash title="run_bepinex.sh"
#!/bin/sh
# BepInEx running script
#
# This script is used to run a Unity game with BepInEx enabled.
#
# Usage: Configure the script below and simply run this script when you want to run your game modded.

# -------- SETTINGS --------
# ---- EDIT AS NEEDED ------

# EDIT THIS: The name of the executable to run
# LINUX: This is the name of the Unity game executable 
# MACOS: This is the name of the game app folder, including the .app suffix
# highlight-next-line
executable_name="StreetsOfRogue.app"

# The rest is automatically handled by BepInEx
# ...
```

Откройте терминал в корневой папке игры и дайте скрипту разрешение на выполнение:

<BrowserWindow>

```bash
chmod u+x run_bepinex.sh
```

</BrowserWindow>

Теперь вы можете запустить BepInEx, выполнив этот скрипт:

<BrowserWindow>

```bash
./run_bepinex.sh
```

</BrowserWindow>

</TabItem>
</Tabs>

### Запускаем BepInEx через Steam {#bepinex-steam}

<Tabs
    groupId="os"
    defaultValue="win"
    values={[
        {label: 'Windows', value: 'win'},
        {label: 'Linux', value: 'linux'},
        {label: 'macOS', value: 'macos'},
    ]}>
<TabItem value='win'>

На Windows вы можете запускать BepInEx через Steam тоже. Не о чем беспокоиться.

</TabItem>
<TabItem value='linux'>

Откройте Библиотеку игр Steam, кликните ПКМ по игре и нажмите **Свойства**:

:::note
Нужен скриншот
:::

Нажмите **Параметры запуска...**:

:::note
Нужен скриншот
:::

И введите:

```bash
./run_bepinex.sh %command%
```

Нажмите **ОК** и запустите игру через Steam.

</TabItem>
<TabItem value='macos'>

Откройте Библиотеку игр Steam, кликните ПКМ по игре и нажмите **Свойства**:

:::note
Нужен скриншот
:::

Нажмите **Параметры запуска...**:

:::note
Нужен скриншот
:::

Теперь, откройте терминал в корневой папке игры и выполните:

<BrowserWindow>

```bash
pwd
```

</BrowserWindow>

Выведется полный путь к корневой папке игры. Скопируйте и вставьте его в поле параметров запуска и добавьте к концу `/run_bepinex.sh %command%`:

```bash
<PWD>/run_bepinex.sh %command%
```

где `<PWD>` - полный путь к корневой папке игры.

Нажмите **ОК** и запустите игру через Steam.

</TabItem>
</Tabs>

## Устанавливаем RogueLibs {#roguelibs}

<Tabs
    defaultValue="v2"
    values={[
        {label:'RogueLibs v2.x.x', value:'v2'},
        {label:'RogueLibs v3.x.x', value:'v3'},
    ]}>
<TabItem value="v2">

**[Скачайте последнюю версию RogueLibs](https://github.com/Abbysssal/RogueLibs/releases/latest)**

Вам нужно скачать только один файл - `RogueLibs.dll`.

:::note
Нужен скриншот
:::

Перейдите к папке `BepInEx` и положите `RogueLibs.dll` в папку `plugins`:

:::note
Нужен скриншот/GIF
:::

</TabItem>
<TabItem value="v3">

:::caution
RogueLibs v3.x.x всё ещё в бете! Скопируйте свои файлы сохранения перед установкой.
:::

**[Скачайте последнюю версию RogueLibs](https://github.com/Abbysssal/RogueLibs/releases)**

Вам нужно скачать только два файла: `RogueLibsCore.dll` и `RogueLibsPatcher.dll`.

:::note
Нужен скриншот
:::

Перейдите к папке `BepInEx` и положите `RogueLibsCore.dll` в папку `plugins`:

:::note
Нужен скриншот/GIF
:::

Положите `RogueLibsPatcher.dll` в папку `patchers` (не `plugins`!):

:::note
Нужен скриншот/GIF
:::

</TabItem>
</Tabs>

## Устанавливаем плагины (моды) {#plugins}

Скачайте плагины, которые вы хотите установить (`.dll` файлы).

И положите эти `.dll` файлы в папку `BepInEx/plugins`.

:::note
Нужен скриншот
:::
